header
  nav(class="navbar navbar-expand-md navbar-dark fixed-top bg-dark")
    div(class="container-fluid")
      a(class="navbar-brand" href="/") Findings Manager
      button( class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation")
        span(class="navbar-toggler-icon")
      div(class="collapse navbar-collapse" id="navbarCollapse")
        ul(class="navbar-nav me-auto mb-2 mb-md-0")
          if isAuthenticated && (!currentUser.twoFAEnabled || (currentUser.twoFAEnabled && is2FAVerified))
            li.nav-item
              a.nav-link(aria-current='page' href='/dashboard') Dashboard
            li.nav-item
              a.nav-link(href='/findings') Findings
            li.nav-item
              a.nav-link(href='/me/profile') Profile
            if currentUser && currentUser.role === 'admin'
              li.nav-item.dropdown
                a.nav-link.dropdown-toggle(href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false")
                  | Admin
                ul.dropdown-menu
                  li
                    a.dropdown-item(href="/admin/users") Users
                  li
                    a.dropdown-item(href="/admin/projects") Projects
                  li
                    a.dropdown-item(href="/admin/products") Products
                  li
                    a.dropdown-item(href="/admin/settings") Settings
            li.nav-item
              a.nav-link(href="/auth/signout") Logout
          else
            li.nav-item
              a.nav-link(href='/auth/signin') Signin
